<?php

class Regles {


    public static function reglesAll()
    {
        $pdo = new PDO('mysql:host=127.0.0.1;dbname=zotcoloc;charset=utf8', 'root', '');
        $error = null;
        $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
        try{
            $query = $pdo->query("SELECT * FROM `regles` ORDER BY `regles`.`libelle_regle` ASC");
            $data = $query->fetchAll(PDO::FETCH_OBJ);
            return array(true, $data);
        }catch(PDOException $e){
            $error = $e->getMessage();
            return array(false, $error);
        }
    }

    // public static function reglesLogement($id_logement, $id_regle)
    // {
    //     $pdo = new PDO('mysql:host=127.0.0.1;dbname=zotcoloc;charset=utf8', 'root', '');
    //     $error = null;
    //     $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    //     try{
    //         $query = $pdo->query("INSERT INTO `regle_logement`(`id_logement`, `id_regle`, `selectionne`) VALUES ('$id_logement','$id_regle',1)");
    //         return array(true, '');
    //     }catch(PDOException $e){
    //         $error = $e->getMessage();
    //         return array(false, $error);
    //     }
    // }

    public static function reglesByIdLogement($id)
    {
        $pdo = new PDO('mysql:host=127.0.0.1;dbname=zotcoloc;charset=utf8', 'root', '');
        $error = null;
        $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
        try{
            $query = $pdo->query("SELECT id 
            FROM regles
            INNER JOIN regle_logement ON regle_logement.id_regle = regles.id
            WHERE regle_logement.id_logement = '$id'
            
            ");
            $data = $query->fetchAll(PDO::FETCH_OBJ);
            return array(true, $data);
        }catch(PDOException $e){
            $error = $e->getMessage();
            return array(false, $error);
        }
    }


}